/*test.src.main*/
!function(t){var e,n=Array.prototype.forEach,i=Array.prototype.slice,r=Object.prototype.toString,o=Object.keys,s={};s.each=function(t,e,i){if(!t)return t;if(i=i||t,n&&t.forEach)t.forEach(e);else if(s.isArray(t))for(var r=0;r<t.length&&(!t[r]||!e.call(i,t[r],r,t));r+=1);else for(var o in t)if(t.hasOwnProperty(o)&&o&&e.call(i,t[o],o,t))break;return t},s.eachReverse=function(t,e,n){if(t){var i;for(i=t.length-1;i>-1&&(!t[i]||!e.call(n,t[i],i,t));i-=1);}return t},s.extend=function(t){return s.each(i.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},s.isObject=function(t){return t===Object(t)},s.defaults=function(t,e){if(void 0===e)return t;for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n]);return e},s.keys=function(t){if(!s.isObject(t))return[];if(o)return o(t);var e=[];for(var n in t)e.push(n);return e},s.isEmpty=function(t){if(null==t)return!0;if(t instanceof Array||t instanceof String)return 0===t.length;for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},s.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){s["is"+t]=function(e){return r.call(e)=="[object "+t+"]"}}),s.isArray=Array.isArray||function(t){return"[object Array]"==r.call(t)},s.async=function(t,e){setTimeout(function(){t.apply(e,Array.prototype.slice.call(arguments,2))})};var a=t.z=function(t,n){if(s.isFunction(t)&&(n=t,t=e),a.has(t)&&!n)return a.modules[t];var i=c(t);return s.isFunction(n)&&2===n.length?f(i,n):n&&i.exports(n),i},u=t.module;t.module=a,a.noConflict=function(){t.module=u};var c=function(t){if("undefined"==typeof t){var e;if(!m)return h=new P;e=b||v.getInteractiveScript(),t=e.getAttribute("data-from")}return a.modules[t]=new P,a.modules[t]},f=function(t,e){var n=function(){return P.prototype.imports.apply(t,arguments)},i=function(){return P.prototype.exports.apply(t,arguments)};e.call(t,n,i)},h=null;a.modules={},a.has=function(t){return a.modules.hasOwnProperty(t)},a.ensureModule=function(t){var e=h;null!==e&&(h=null,!e instanceof P||(a.modules[t]=e))},a.config={root:"",shim:{},alias:{},env:"browser",auto:!0},a.setup=function(t){a.config=s.defaults(a.config,t)};var l=/xyz/.test(function(){})?/\b__super__\b/:/[\D|\d]*/,d=function(t){var e=this.prototype,n=this,i=s.isFunction(t.__new__)?function(){var e=t.__new__;return delete t.__new__,e}():function(){n.apply(this,arguments)},r=function(){this.constructor=i};r.prototype=this.prototype,i.prototype=new r;for(var o in t)i.prototype[o]=s.isFunction(t[o])&&s.isFunction(e[o])&&l.test(t[o])?function(t,n){return function(){var i=this.__super__;this.__super__=e[t];var r=n.apply(this,arguments);return this.__super__=i,r}}(o,t[o]):t[o];return i.prototype.constructor=i,i.extend=arguments.callee,i},p=function(){this.__init__&&this.__init__.apply(this,arguments)};a.Class=function(t,e){if(e||(e=t,t=!1),!t)return d.call(p,e);if(t&&hasOwnProperty.call(t,"extend"))return t.extend(e);if(s.isFunction(t))return d.call(t,e);if(s.isObject(t))return t.__new__=p,d.call(t,e);throw new TypeError("{parent} must be a function, object or undefined.")};var _={PENDING:0,READY:1,REJECTED:-1},y=a.Resolver=a.Class({__new__:function(){this._onReady=[],this._onRejected=[],this._value=null,this._state=_.PENDING,this.__init__&&this.__init__.apply(this,arguments)},done:function(t,e){return t&&(this.isReady()?t(this._value):this._onReady.push(t)),e&&(this.isRejected()?e(this._value):this._onRejected.push(e)),this},failed:function(t){return this.ready(void 0,t)},then:function(t){return this.ready(t,onFailed)},resolve:function(t){this._value=t,this._state=_.READY,this._dispatch(this._onReady)},reject:function(t){this._value=t,this._state=_.REJECTED,this._dispatch(this._onRejected)},_dispatch:function(t){for(var e=this._value,n=this;t.length;){var i=t.shift();i.call(n,e)}}});s.each(["Ready","Rejected","Pending"],function(t){var e=t.toUpperCase();y.prototype["is"+t]=function(){return this._state===_[e]}});var v=a.Script=y.extend({options:{nodeType:"text/javascript",charset:"utf-8",async:!0},__init__:function(t,e){this.options=s.defaults(this.options,e),this.node=!1,this.load(t)},create:function(){var t=document.createElement("script");return t.type=this.options.nodeType||"text/javascript",t.charset=this.options.charset,t.async=this.options.async,t},load:function(t){var e=this.create(),n=document.getElementsByTagName("head")[0],i=this,r=(this.scriptSettings,{src:""});s.isString(t)&&(t={src:t}),t=s.defaults(r,t),e.setAttribute("data-from",t.from||t.src),g(e,function(t){i.resolve(t)},function(t){i.reject(t)}),b=e,e.src=t.src,n.appendChild(e),b=null}}),m=!1,b=null,E=null;v.getInteractiveScript=function(){return E&&"interactive"===E.readyState?E:(s.eachReverse(v.scripts(),function(t){return"interactive"===t.readyState?(E=t,!0):void 0}),E)},v.scripts=function(){return document.getElementsByTagName("script")};var g=function(){if("undefined"==typeof document)return function(){};var t=document.createElement("script"),e=null;return e=t.attachEvent?function(t,e){m=!0,t.attachEvent("onreadystatechange",function(){"complete"===t.readyState&&(e(t),E=null)})}:function(t,e,n){t.addEventListener("load",function(){e(t)},!1),t.addEventListener("error",function(t){n(t)},!1)}}();a.script=function(t,e,n){var i=new v(t,a.config.script);return i.done(e,n),i};var x={PENDING:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,FAILED:-1},w=["GET","PUT","POST","DELETE"],j=a.Ajax=y.extend({options:{defaults:{src:"",method:"GET",data:!1}},__init__:function(t,e){this.options=s.defaults(this.options,e),this.load(t)},load:function(t){var e,n=this,i="GET";if(t=s.defaults(this.options.defaults,t),i="GET"===t.method.toUpperCase(),w.indexOf(i)<=0&&(i="GET"),e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e.onreadystatechange=function(){x.DONE===this.readyState&&(200===this.status?n.resolve(this.responseText):n.reject(this.status))},"GET"===i&&t.data&&(t.src+="?"+this._buildQueryStr(t.data)),e.open(i,t.src,!0),"POST"===i&&t.data){var r=this._buildQueryStr(t.data);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(r)}else e.send()},_buildQueryStr:function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")}});s.each(["Done","Pending","Failed"],function(t){j.prototype["is"+t]=function(){return this._state===x[t.toUpperCase()]}}),a.ajax=function(t,e,n){var i=new j(t,a.config.ajax);return i.done(e,n),i};var A=function(t){this._queue={},t=t||{},this._filters=t.filters||["default.src"],this.options=s.defaults(this.options,t.options),this._method=t.method||a.Script,this._handler=t.handler||function(t,e,n){n(e)},this._build=t.build||!1};A.prototype.options={ext:"js"},A.prototype.prefilter=function(t){var e=this;return s.each(this._filters,function(n){var i=a.filter(n);i&&(t=i.call(e,t))}),t},A.prototype.method=function(t){return this._method=t,this},A.prototype.filters=function(t){return t?s.isArray(t)?void this._filters.concat(t):(this._filters.push(t),this):void 0},A.prototype.handler=function(t){return t?(this._handler=t,this):this},A.prototype.build=function(t){return t?(this._build=t,this):this},A.prototype.has=function(t){return this._queue.hasOwnProperty(t)},A.prototype.load=function(t,e,n){var i=this;return t=this.prefilter(t),this.has(t.src)||(this._queue[t.src]=new this._method(t)),this._queue[t.src].done(function(r){i._handler(t,r,e,n),"browser"!==a.config.env&&i._build&&a.loader.build(t,r,i)},n),this};var O={};a.loader=function(t,e){return arguments.length<=1&&O.hasOwnProperty(t)?O[t]:(O[t]=new A(e),O[t])},a.loader.build=function(){},_filters={},a.filter=function(t,e){return arguments.length<=1?_filters.hasOwnProperty(t)?_filters[t]:!1:(_filters[t]=e,_filters[t])};a.Resolver.extend({load:function(t){if(console.log("loading"),a.has(t.from))this.resolve(t);else{var e=this;setTimeout(function(){e.resolve(t)},0)}}});a.loader("script",{method:a.UseModule,filters:["default.src"],handler:function(t,e,n){n()},options:{ext:"js"}}),a.loader("ajax",{method:a.UseModule,filters:["default.src","ajax.method"],handler:function(t,e,n){n()},options:{ext:"js",method:"GET"}}),a.filter("default.src",function(t){if(t.src)return t;var e=a.config.shim,n=a.config.alias,i=t.from,r=t.options.ext||this.options.ext,o=i.split("."),u=[],c="";return s.each(o,function(t,e){if(n.hasOwnProperty(t)){if(""===n[t]||n[t]===!1)return;u.push(n[t])}else u.push(o[e])}),i=u.join("."),e.hasOwnProperty(i)?c=e[i].src:(c=i.replace(/\./g,"/"),c=a.config.root+c+"."+r,c=c.trim("/")),t.src=c,t}),a.filter("ajax.method",function(t){return t.method=t.method||this.options.method,t});var R={PENDING:0,LOADED:1,ENABLED:2,FAILED:-1},P=function(t){this._deps=t&&s.isArray(t)?t:[],this._state=R.PENDING,this._factory=null,this._definition=null,this._onReady=[],this._onFailed=[]},D=/\s?([\S]+?)\s?\@\s?([\S]+?)\s?$/;P.prototype.use=function(t){if(!this.isEnabled())return!1;var e=this,n=!1,i={};return t?(s.isArray(t)||(n=!0,t=[t]),s.each(t,function(t){var r=t,o=t;D.test(t)&&t.replace(D,function(t,e,n){return o=e,r=n,t}),e._definition.hasOwnProperty(o)&&(n?i=e._definition[o]:i[r]=e._definition[o])}),i):this._definition},P.prototype.imports=function(t,e,n){this._state=R.PENDING;var i=!1;if(D.test(t)){var r=t;r.replace(D,function(e,n,r){t=n.trim(),i=r.trim()})}e=e&&"*"!==e?s.isArray(e)?e:[e]:!1,n=s.defaults({type:"script"},n);var o={from:t,alias:i,uses:e,options:n};return this._deps.push(o),this},P.prototype.exports=function(t,e){return arguments.length<=1&&(e=t,t=!1),t?(null===this._factory&&(this._factory={}),this._factory[t]=e):this._factory=e,s.async(function(){this.enable()},this),this},P.prototype.enable=function(t,e){return this.done(t,e),this.isPending()?(T.call(this),this):this.isLoaded()?(S.call(this),this):this.isFailed()?(F.call(this,this._onFailed,this),this._onFailed=[],this):(this.isEnabled()&&(F.call(this,this._onReady,this),this._onReady=[]),this)},P.prototype.disable=function(){return this.isFailed(!0),this.enable()},P.prototype.done=function(t,e){return s.async(function(){t&&s.isFunction(t)&&(this.isEnabled()?t.call(this):this._onReady.push(t)),e&&s.isFunction(e)&&(this.isFailed()?e.call(this):this._onFailed.push(e))},this),this},P.prototype.fail=function(t){return this.done(e,t)},s.each(["Enabled","Loaded","Pending","Failed"],function(t){var e=R[t.toUpperCase()];P.prototype["is"+t]=function(t){return t&&(this._state=e),this._state===e}});var F=function(t,e){s.each(t,function(t){t.call(e)})},T=function(){var t=[],e=this;s.each(this._deps,function(e){!1===a.has(e.from)&&t.push(e)});var n=t.length;n>0?s.each(t,function(t){var i=t.options.type||"script",r=a.loader(i);r.load(t,function(){n-=1,0>=n&&(e.isLoaded(!0),e.enable())},function(t){throw e.disable(),t})}):(this.isLoaded(!0),this.enable())},S=function(){var t={},e=this;if(s.each(this._deps,function(n){if(t){if(!a.has(n.from))throw new Error("A dependency is not in the registry: "+n.from);var i=a(n.from),r={};if(i.isFailed())throw e.disable(),new Error("A dependency failed: "+n.from);if(!i.isEnabled())return i.enable().done(function(){e.enable()}),t=!1,!0;n.uses?r=i.use(n.uses):n.alias?r[n.alias]=i._definition:r[n.from.split(".").pop()]=i._definition,t=s.extend(t,r)}}),t){try{"server"!==a.config.env?s.isFunction(this._factory)?this._definition=this._factory(t):s.isObject(this._factory)?(this._definition={},s.each(this._factory,function(n,i){e._definition[i]=s.isFunction(n)?n(t):n})):this._definition=this._factory:this._definition=!0}catch(n){throw this.disable(),n}this.isEnabled(!0),this.enable()}};t.define=function(e,n,i){2===arguments.length&&(i=n,n=e,e=void 0),1===arguments.length&&(i=e,n=[],e=void 0);var r=a(e);s.each(n,function(t){r.imports(t.split("/").join("."))}),r.exports(function(e){var n=[];for(var r in e)n.push(e[r]);var o,a=t.exports,u=t.module;return t.exports={},t.module={},o=i.apply(this,n),!1===s.isEmpty(t.exports)&&(o=t.exports),t.module.exports&&(o=t.module.exports),t.exports=a,t.module=u,o})},t.define.amd={jQuery:!0},a.setup({root:"",shim:{},alias:{fud:"test.src"}}),a("main").imports("fud.bar","*").exports(function(t){document.write(t.bar.bar);var e=t.bar;return{fud:e}}),a("fud.bar").imports("fud.foo","foo").imports("fud.bin","bin").exports(function(t){var e="bar"+t.foo,n=("bin"+t.bin,a.Class({__init__:function(){this.foo="foo"}}));return{bar:e,testClass:n}}),a("fud.foo",function(){var t="foo";return{foo:t}});var N=a("fud.bin").imports("fud.foob","foob").imports("fud.txt.test","*",{type:"ajax",ext:"txt"});N.exports(function(t){var e="bin"+t.foob;return{bin:e}}),a("fud.foob",function(){var t="foob";return{foob:t}}),a("fud.txt.test").exports(function(){return"test"})}(window);