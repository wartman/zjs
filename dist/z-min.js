/*! z | 2014-04-04 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=function(){var b=[],c=function(a){return 1===b.push(a)},d=function(){var a=b,c=0,d=b.length;for(b=[];d>c;)a[c++]()};if("undefined"!=typeof setImmediate&&"function"==typeof setImmediate)return function(a){c(a)&&setImmediate(d)};if("object"==typeof process&&process.nextTick)return function(a){c(a)&&process.nextTick(d)};if(a.postMessage){var e=!0;if(a.attachEvent){var f=function(){e=!1};a.attachEvent("onmessage",f),a.postMessage("__checkAsync","*"),a.detachEvent("onmessage",f)}if(e){var g="__promise"+new Date,h=function(a){a.data===g&&(a.stopPropagation&&a.stopPropagation(),d())};return a.addEventListener?a.addEventListener("message",h,!0):a.attachEvent("onmessage",h),function(b){c(b)&&a.postMessage(g,"*")}}}return function(a){c(a)&&setTimeout(d,0)}}(),d=function(a,b,c){if(!a)return a;if(c=c||a,Array.prototype.forEach&&a.forEach)a.forEach(b);else if(a instanceof Array)for(var d=0;d<a.length&&(!a[d]||!b.call(c,a[d],d,a));d+=1);else for(var e in a)if(a.hasOwnProperty(e)&&e&&b.call(c,a[e],e,a))break;return a},e=function(a,b){if(!(this instanceof e))return new e(a,b);if(e.namespaceExists(a))throw Error("Namespace was already defined: "+a);delete e.env.namespaces[a];for(var c=a;(c=c.substring(0,c.lastIndexOf(".")))&&!e.getObjectByName(c);)e.env.namespaces[c]=!0;e.env.modules[a]=this,this._state=e.env.MODULE_STATE.PENDING,this._namespaceString=a,this._namespace=e.createNamespace(a),this._dependencies=[],this._factory=null,this._onFailed=[],this._onReady=[],b&&"function"==typeof b&&(b.length<2?this.export(b):b(this.import.bind(this),this.export.bind(this)))};if(e.env={namespaces:{},root:"",map:{},shim:{},modules:{},environment:"browser",MODULE_STATE:{PENDING:0,LOADED:1,ENABLED:2,FAILED:-1}},e.global=a,e.namespaceExists=function(a){return!e.env.namespaces[a]&&e.env.namespaces[a]!==b},e.map=function(a,b){e.env.map[a]||(e.env.map[a]=[]),e.env.map[a]=e.env.map[a].concat(b)},e.shim=function(a,b){b=b||{},b.map&&e.map(b.map,[a]),e.env.shim[a]=b},e.getMappedPath=function(a){var b=!1,c=a.substring(0,a.lastIndexOf("."))+".*";return d(e.env.map,function(a,d){a.indexOf(c)>-1&&(b=d)}),b?b:(d(e.env.map,function(c,d){c.indexOf(a)>-1&&(b=d)}),b)},e.createNamespace=function(a,c,d){for(var f,g=d||e.global,h=a.split(".");h.length&&(f=h.shift());)h.length||c===b?g=g[f]?g[f]:g[f]={}:g[f]=c;return g},e.getObjectByName=function(a,b){for(var c,d=b||e.global,f=a.split(".");c=f.shift();){if("undefined"==typeof d[c])return null;d=d[c]}return d},e.prototype.import=function(a){return this._dependencies.push(a),this},e.prototype.export=function(a){var b=this;return this._factory=a,c(function(){b.enable()}),this},e.prototype.enable=function(){return this.isPending()?(this.getDependencies(),this):this.isLoaded()?(this.runFactory(),this):this.isFailed()?(this._dispatch(this._onFailed),this._onFailed=[],this):(this.isEnabled()&&(this._dispatch(this._onReady),this._onReady=[]),this)},e.prototype.done=function(a,b){var d=this;return c(function(){a&&"function"==typeof a&&(d.isEnabled()?a.call(d):d._onReady.push(a)),b&&"function"==typeof b&&(d.isFailed()?b.call(d):d._onFailed.push(b))}),this},e.prototype.catch=function(a){return this.done(null,a),this},e.prototype.disable=function(a){return this.isFailed(!0),this.catch(function(){c(function(){throw Error(a)})}),this.enable()},e.prototype.getDependencies=function(){var a=[],b=this,c=this._dependencies.length;d(this._dependencies,function(b){null===e.getObjectByName(b)&&a.push(b)}),c=a.length;var f=c;return c>0?d(a,function(a){e.global.MODULE_LOADER(a,function(){f-=1,0>=f&&(b.isLoaded(!0),b.enable())},function(){b.disable("Could not load dependency: "+a)})}):(this.isLoaded(!0),this.enable()),this},e.prototype.runFactory=function(){var a=!0,b=this;if(d(this._dependencies,function(c){if(a){if(e.env.shim.hasOwnProperty(c))return void(e.env.namespaces[c]=!0);if(!e.env.modules.hasOwnProperty(c))return b.disable("A dependency was not loaded: "+c),void(a=!1);var d=e.env.modules[c];return d.isFailed()?(b.disable("A dependency failed: "+c),void(a=!1)):d.isEnabled()?void 0:(d.enable().done(function(){b.enable()}),void(a=!1))}}),a){if(this._factory||this.disable("No factory defined: "+this._namespaceString),"node"!==e.env.environment?this._factory.call(this._namespace):this._factory=this._factory.toString(),this._namespace.hasOwnProperty("exports")){var c=this._namespace.exports;e.createNamespace(this._namespaceString,c),this._namespace=e.getObjectByName(this._namespaceString)}this.isEnabled(!0),this.enable()}},e.prototype._dispatch=function(a,b){b=b||this,d(a,function(a){a.call(b)})},d(["Enabled","Loaded","Pending","Failed"],function(a){var b=e.env.MODULE_STATE[a.toUpperCase()];e.prototype["is"+a]=function(a){return a&&(this._state=b),this._state===b}}),!e.global.MODULE_LOADER){var f={};e.global.MODULE_LOADER=function(a,b,c){var d=e.getMappedPath(a);if(d||(d=a.replace(/\./g,"/")+".js"),d=e.env.root+d,f.hasOwnProperty(d))return void f[d].done(b,c);var h=document.createElement("script"),i=document.getElementsByTagName("head")[0];h.type="text/javascript",h.charset="utf-8",h.async=!0,h.setAttribute("data-namespace",a),f[d]=new g,f[d].attachEvent(h,b,c),h.src=d,i.appendChild(h)};var g=function(){this._onReady=[],this._onFailed=[],this._state=0};g.prototype.attachEvent=function(){var a=document.createElement("script");return a.attachEvent?function(a,b,c){var d=this;this.done(b,c),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&d.dispatch(d._onReady)})}:function(a,b,c){var d=this;this.done(b,c),a.addEventListener("load",function(){d.dispatch(d._onReady)},!1),a.addEventListener("error",function(){d.dispatch(d._onFailed)},!1)}}(),g.prototype.done=function(a,b){var d=this;return c(function(){a&&"function"==typeof a&&(1===d._state?a.call(d):d._onReady.push(a)),b&&"function"==typeof b&&(-1===d._state?b.call(d):d._onFailed.push(b))}),this},g.prototype.dispatch=function(a){d(a,function(a){a()})}}var h=e.global.module;e.global.module=e,e.noConflict=function(){e.global.module=h},a.z=a.z||e});